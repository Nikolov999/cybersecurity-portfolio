<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Pre-Exfiltration Initial Access, Staging and Compression — EchoPurple</title>
<meta name="description" content="WinRM initial access → remote execution baseline → staging concentration → compression prep (no outbound). Evidence screenshots included."/>

<style>
/* ---------- SAME STYLE SYSTEM AS TEMPLATE ---------- */
:root{
--bg0:#07040d;--bg1:#0b0614;--bg2:#100a1e;
--stroke:rgba(255,255,255,0.10);
--text:#f5f1ff;--muted:rgba(245,241,255,0.72);
--p1:#6d28d9;--p2:#a855f7;--p3:#22d3ee;
--radius:18px;--header-h:98px;
--shadow:0 18px 60px rgba(0,0,0,.55);
--shadow-soft:0 10px 30px rgba(0,0,0,.35);
}

*{box-sizing:border-box;margin:0;padding:0}
body{
font-family:Inter,system-ui;
color:var(--text);
background:
radial-gradient(900px 520px at 16% -10%, rgba(168,85,247,.24), transparent 60%),
radial-gradient(860px 520px at 88% 0%, rgba(34,211,238,.14), transparent 55%),
linear-gradient(180deg,var(--bg0),var(--bg1) 30%,var(--bg2));
min-height:100vh;display:flex;flex-direction:column;
}

header{
position:fixed;top:0;left:0;right:0;
display:flex;align-items:center;justify-content:space-between;
padding:0 40px;min-height:var(--header-h);
background:linear-gradient(90deg,rgba(109,40,217,.95),rgba(168,85,247,.9) 45%,rgba(34,211,238,.25));
border-bottom:1px solid rgba(255,255,255,.12);
box-shadow:0 12px 40px rgba(0,0,0,.55);
z-index:1000;
}

.logo img{height:70px}
.subtitle{font-size:13px;color:rgba(255,255,255,.8)}
nav a{color:#fff;text-decoration:none;font-weight:700;margin-left:20px}

main{
padding:calc(var(--header-h) + 20px) 40px 40px;
display:flex;flex-direction:column;gap:20px;flex:1;
}

.section{
background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
border-radius:var(--radius);
padding:26px;
border:1px solid var(--stroke);
box-shadow:var(--shadow-soft);
}

h1{font-size:28px;margin-bottom:8px}
h2{font-size:20px;margin-bottom:12px}
p{color:var(--muted);line-height:1.7}
ul{margin-top:10px;padding-left:18px;color:var(--muted)}
li{margin:6px 0}

.pillbar{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
.pill{
padding:6px 12px;border-radius:999px;
font-size:12px;
background:rgba(34,211,238,.08);
border:1px solid rgba(34,211,238,.18);
}
.pill.primary{
background:linear-gradient(135deg,var(--p1),var(--p2));
border:1px solid rgba(255,255,255,.15);
color:#fff;
}

.actions{margin-top:14px;display:flex;gap:12px;flex-wrap:wrap}
.btn{
padding:10px 14px;
border-radius:12px;
text-decoration:none;
font-weight:800;
font-size:13px;
border:1px solid rgba(255,255,255,.14);
}
.btn-solid{
background:linear-gradient(135deg,var(--p1),var(--p2));
color:#fff;
}
.btn-ghost{
background:rgba(0,0,0,.2);
color:var(--text);
}

/* ---------- Gallery ---------- */

.gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:16px}
figure{cursor:pointer;border-radius:14px;overflow:hidden;border:1px solid rgba(255,255,255,.1)}
figure img{width:100%;display:block}
figcaption{padding:8px;font-size:12px;color:rgba(245,241,255,.85);background:rgba(0,0,0,.2)}

.lightbox{
position:fixed;inset:0;
background:rgba(0,0,0,.85);
display:flex;align-items:center;justify-content:center;
opacity:0;pointer-events:none;
transition:.25s;
z-index:2000;
}
.lightbox.active{opacity:1;pointer-events:auto}
.lightbox img{
max-width:90%;
max-height:90%;
border-radius:14px;
box-shadow:0 0 60px rgba(0,0,0,.8);
}

footer{
text-align:center;
padding:20px;
background:linear-gradient(90deg,var(--p1),var(--p2) 45%,rgba(34,211,238,.25));
color:#fff;
}

@media(max-width:900px){
.gallery{grid-template-columns:1fr}
main{padding:calc(var(--header-h) + 20px) 20px 40px}
}
</style>
</head>

<body>

<header>
<div>
<div class="logo"><img src="../../Logo/Portfolio_Logo.png.png"></div>
</div>
<nav>
<a href="../../projects.html">← Projects</a>
<a href="../../index.html">Home</a>
</nav>
</header>

<main>

<section class="section">
<h1>Pre-Exfiltration Initial Access, Staging and Compression</h1>
<p>
WinRM-based initial access and remote execution baseline on <strong>lab-win-client</strong>, followed by internal exfiltration preparation signals
(staging concentration + compression preparation). No outbound transfer performed.
</p>

<div class="pillbar">
<span class="pill primary">Purple Team</span>
<span class="pill">WinRM Remote Execution</span>
<span class="pill">Security: 4624/4634/4672/4674</span>
<span class="pill">Sysmon: Event ID 1</span>
<span class="pill">PowerShell: Operational</span>
<span class="pill">Pre-Exfil Preparation</span>
<span class="pill">MITRE: T1021.006 / T1074 / T1560</span>
</div>

<div class="actions">
<a class="btn btn-solid" href="../../viewer.html?src=Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/README.md">Project README</a>
<a class="btn btn-ghost" href="../../viewer.html?src=Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/detections/rules.md">Detection Rules</a>
<a class="btn btn-ghost" href="../../viewer.html?src=Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/telemetry/event-map.md">Telemetry Map</a>
<a class="btn btn-ghost" href="../../viewer.html?src=Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/docs/attack-narrative.md">Attack Narrative</a>
</div>
</section>

<section class="section">
<h2>Detection Logic</h2>
<ul>
<li>Security 4624 with <strong>Logon Type 3</strong> from attacker IP (session anchor)</li>
<li>Sysmon 1 showing child process spawned by <strong>wsmprovhost.exe -Embedding</strong> (remote execution baseline)</li>
<li>Security 4672/4674 confirming elevated privilege context (risk amplifier)</li>
<li>PowerShell Operational showing compression/archive preparation activity</li>
<li>Security 4634 logoff to close session correlation window</li>
</ul>
<p>
This models internal exfiltration preparation where data is staged and readied for transfer without generating outbound traffic.
</p>
</section>

<section class="section">
<h2>Evidence Gallery</h2>

<div class="gallery">

<figure>
<img src="../../Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/evidence/ui/01-Alerts-Dashboard.png">
<figcaption>EchoSentinel — Alerts (WinRM execution + privilege context)</figcaption>
</figure>

<figure>
<img src="../../Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/evidence/ui/02-Dashboard.png">
<figcaption>EchoSentinel — Events view (ingested telemetry)</figcaption>
</figure>

<figure>
<img src="../../Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/evidence/ui/03-WinRM-LogOn.png">
<figcaption>Security 4624 — WinRM Logon (Type 3) with attacker source IP</figcaption>
</figure>

<figure>
<img src="../../Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/evidence/ui/04-sysmon-1-event-whoami.png">
<figcaption>Sysmon 1 — whoami.exe spawned by wsmprovhost.exe (-Embedding)</figcaption>
</figure>

<figure>
<img src="../../Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/evidence/ui/05-sysmon-1-event-whoami-priv.png">
<figcaption>Sysmon 1 — whoami.exe with elevated context (priv baseline)</figcaption>
</figure>

<figure>
<img src="../../Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/evidence/ui/06-powershell-4013-event.png">
<figcaption>PowerShell Operational — Compression/Archive preparation telemetry</figcaption>
</figure>

<figure>
<img src="../../Projects/Pre-Exfiltration_Initial-Access_Staging_Compression_Exfiltration-Series/evidence/ui/07-WinRM-LogOff.png">
<figcaption>Security 4634 — WinRM Logoff (session end)</figcaption>
</figure>

</div>
</section>

</main>

<footer>
© Bobo Nikolov
</footer>

<div class="lightbox" id="lightbox">
<img src="">
</div>

<script>
const lightbox = document.getElementById('lightbox');
const lightboxImg = lightbox.querySelector('img');

document.querySelectorAll('.gallery img').forEach(img=>{
img.addEventListener('click',()=>{
lightbox.classList.add('active');
lightboxImg.src = img.src;
});
});

lightbox.addEventListener('click',()=>lightbox.classList.remove('active'));
document.addEventListener('keydown',e=>{
if(e.key === "Escape") lightbox.classList.remove('active');
});

// Hide broken images
document.querySelectorAll('.gallery img').forEach(img=>{
img.onerror = ()=> img.closest('figure').style.display="none";
});
</script>

</body>
</html>
