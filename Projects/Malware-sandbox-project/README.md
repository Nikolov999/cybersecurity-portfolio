# Malware Analysis & Sandbox Project (Simulation-Based)

This project is a **safe, simulation-based malware analysis lab** designed to
practice:

- Windows process and registry monitoring
- Sysmon-based logging and analysis
- Detection engineering (Sigma-style rules, hunting queries)
- Basic “malware-like” behaviour analysis **without using real malware**

> ⚠️ No real malware is used in this project.  
> All scripts are benign simulations intended purely for education and blue-team practice.

---

## 1. Lab overview

**Goal:**  
Simulate common malware behaviours (keylogging-like logging, persistence-like
registry changes, beacon-like repeated actions) in a controlled Windows VM,
then analyze and detect these behaviours using Sysmon and log analysis.

**Core components:**

- 1 × Windows 10 VM (sandbox)
- Sysmon + Sysinternals tools
- 3 benign “malware-behaviour simulators”:
  - `fake_keylogger_sim.py`
  - `fake_persistence_sim.ps1`
  - `fake_beacon_sim.py`
- Analysis notes under `analysis/`
- Detection rules under `detection-rules/`

---

## 2. Environment (sandbox) setup

See `sandbox-setup/VM-network-setup.md` for detailed setup.

Short version:

- Create an **isolated Windows 10 VM** (host-only / internal network).
- Install **Sysmon** (using a standard config, e.g. SwiftOnSecurity’s).
- Install **Sysinternals Suite**:
  - Process Explorer
  - Process Monitor
  - Autoruns
- Ensure:
  - No sensitive data in the VM
  - No internet needed (all scripts are local-only)
  - You have a VM snapshot you can roll back to

---

## 3. Simulated “malware-like” behaviours

All scripts live in `simulated-malware/` and are **benign**, local-only.

### 3.1 `fake_keylogger_sim.py`

Simulates “keylogging-like” activity by writing synthetic keystrokes to a file
in a loop, without reading real keyboard input.

You can observe:

- Process creation
- File write events (Sysmon Event ID 11)

See `analysis/keylogger-analysis.md` for what to look for.

### 3.2 `fake_persistence_sim.ps1`

Simulates “persistence-like” behaviour by:

- Copying itself (or another file) to a known directory
- Creating / modifying a **non-critical** registry key under:
  `HKCU:\Software\SandboxDemo\PersistenceDemo`

You can observe:

- Registry modification events (Sysmon Event ID 13)
- Process creation & file write

See `analysis/persistence-analysis.md`.

### 3.3 `fake_beacon_sim.py`

Simulates a simple “beacon-like” pattern by periodically writing timestamped
entries to a log file.

You can observe:

- Long-running process behaviour
- Repeated file writes over time

See `analysis/beacon-analysis.md`.

---

## 4. Analysis workflow

For each simulation:

1. **Start monitoring tools**:
   - Sysmon (via event logs)
   - Process Monitor (optional)
   - Process Explorer (optional)

2. **Run the simulation script**:
   - From `simulated-malware/`

3. **Capture events**:
   - Use Event Viewer → Applications and Services Logs → Microsoft → Windows → Sysmon
   - Filter by relevant Event IDs (1, 11, 13, etc.)

4. **Document behaviour**:
   - What process ran?
   - What files/paths were touched?
   - What registry keys (if any)?
   - Which Sysmon events fired?

5. **Write detection logic**:
   - Draft Sigma-style rules under `detection-rules/`
   - Add example SIEM queries (KQL, Splunk SPL, etc.)

---

## 5. Detection rules

Under `detection-rules/`:

- `sigma_fake_keylogger.yml` — detects repetitive file writes to a “keylog-like” path.
- `sigma_fake_persistence.yml` — detects registry changes under the demo sandbox path.
- `sigma_fake_beacon.yml` — detects a long-running process repeatedly writing to a file.

**Note:** These are illustrative rules. In a real environment, similar patterns may
indicate actual malware; here they are tied to safe simulations.

---

## 6. MITRE ATT&CK mapping (conceptual)

Although this project uses safe simulations, the behaviours approximate:

- **T1056** – Input Capture (conceptual similarity only)
- **T1060 / T1547** – Persistence via registry (conceptual)
- **T1071 / T1055** – Beaconing / periodic activity (conceptual)

---

## 7. Deliverables (for CV / portfolio)

- This `README.md` (project overview and usage)
- `sandbox-setup/VM-network-setup.md` (how you safely built the lab)
- `simulated-malware/*.py` and `.ps1` (benign behaviour simulations)
- `analysis/*.md` (per-simulation analysis notes)
- `detection-rules/*.yml` (Sigma-style rules)

You can link this repo on your CV / LinkedIn as:

> “Malware Behaviour Simulation & Detection Lab – Windows, Sysmon, Sigma, Detection Engineering”

---

## 8. Safety & legal notice

- No real malware was created or executed.
- All scripts are harmless and operate only on synthetic data and demo registry paths.
- This project is strictly for **educational and defensive security purposes**.
- Do not adapt this project to build or deploy real malware.

---

