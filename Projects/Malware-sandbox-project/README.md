#  Malware Analysis Lab – Safe Simulation Environment  
**File-Based Logging | Registry Persistence | Beaconing Simulation | Sysmon Telemetry**

This project implements a fully safe Windows-based malware simulation lab, designed to study **malware-like behaviors** without using any real malicious code.  
All artifacts are harmless and serve only for detection and analysis training.

##  1. Overview

This lab simulates three common malware behaviors:

1. **Keylogger-like file write behavior**  
2. **Registry-based persistence mechanism**  
3. **C2-like periodic beaconing behavior**

Detection and telemetry collection are performed using **Sysmon** with the SwiftOnSecurity config.

---

##  2. Environment Setup

| Component | Details |
|----------|---------|
| OS | Windows Server 2019 / Windows 10 (VM) |
| Monitoring | Sysmon64.exe + SwiftOnSecurity config |
| Languages | Python 3.12, PowerShell |
| Folder | `C:\Sandbox\` |
| Network | Host-only / NAT (sandboxed) |

---

##  3. Folder Structure


 **[PLACEHOLDER — Screenshot: C:\Sandbox folder]**

---

#  4. Simulation 1 — Keylogger-Like Behavior

###  Description  
A safe simulation where Python writes synthetic “keystrokes” to a log file every second.

###  Script  
`fake_keylogger_sim.py`

###  Output  
`C:\Sandbox\logs\fake_keylog.txt`

**[PLACEHOLDER — Script running]**  
**[PLACEHOLDER — fake_keylog.txt content]**

---

## Sysmon Events for Keylogger

### **Event ID 1 — Process Create**
Triggered when python.exe starts the script.

**Expected fields:**
- Image: `python.exe`
- CommandLine: `python fake_keylogger_sim.py`

**[PLACEHOLDER — Sysmon EID 1 for python.exe]**

---

### **Event ID 11 — File Create / Write**
Triggered every second during log creation.

**Expected fields:**
- `TargetFilename: C:\Sandbox\logs\fake_keylog.txt`
- `ProcessGuid: python.exe`

 **[PLACEHOLDER — Sysmon EID 11 entries]**

---

#  5. Simulation 2 — Registry Persistence Behavior

### Description  
PowerShell script simulating registry persistence by creating:
- A folder  
- A harmless EXE  
- A registry Run-like key  

###  Script  
`fake_persistence_sim.ps1`

**Created File:**  
`C:\Sandbox\bin\demo_app.exe`

 **[PLACEHOLDER — Script execution]**  
 **[PLACEHOLDER — demo_app.exe in bin folder]**  
 **[PLACEHOLDER — Registry path in regedit]**

---

##  Sysmon Events for Persistence

### **Event ID 1 — Process Create**
PowerShell launching the script.

 **[PLACEHOLDER — EID 1 PowerShell]**

---

### **Event ID 11 — FileCreate**
Creation of `demo_app.exe`.

**Expected fields:**
- TargetFilename: `C:\Sandbox\bin\demo_app.exe`

 **[PLACEHOLDER — EID 11 demo_app.exe]**

---

### **Event ID 12 / 13 — Registry Changes**

- **EID 12** = Registry object create  
- **EID 13** = Registry value set  

Key created:
HKCU\Software\SandboxDemo\PersistenceDemo
DemoExecutable = C:\Sandbox\bin\demo_app.exe


 **[PLACEHOLDER — EID 13 screenshot]**

---

#  6. Simulation 3 — Beaconing Behavior

###  Description  
Python writes a “BEACON X” entry every 10 seconds for 30 cycles — replicating C2 beacon timing.

###  Script  
`fake_beacon_sim.py`

 **Output:**  
`C:\Sandbox\logs\fake_beacon.txt`

 **[PLACEHOLDER — Script running]**  
  **[PLACEHOLDER — fake_beacon.txt growing]**

---

##  Sysmon Events for Beacon

### **Event ID 1 — Process Create**
python.exe starting the beacon script.

 **[PLACEHOLDER — EID 1 python.exe]**

---

### **Event ID 11 — Regular File Writes**
Triggered every 10 seconds for each beacon write.

**Expected pattern:**
- 30 events
- ~10 seconds apart
- Source: python.exe  
- Target: `fake_beacon.txt`

 **[PLACEHOLDER — Repeated EID 11 timeline]**

---

# 7. Sysmon Event Summary Table

| Event ID | Meaning | Triggered By | Notes |
|---------|---------|--------------|-------|
| **1** | Process Create | Keylogger, Persistence, Beacon | python.exe / powershell.exe |
| **5** | Process Terminate | All scripts | Normal exit behavior |
| **11** | File Create / Write | Keylogger, Persistence, Beacon | Logs, demo_app.exe, beacon writes |
| **12** | Registry Object Create | Persistence | Key created |
| **13** | Registry Value Set | Persistence | Value written to key |

---

#  8. Detection Opportunities

###  Keylogger Simulation
- python.exe producing frequent file writes  
- Logs in user-controlled folder  
- Repetitive write patterns  

###  Persistence Simulation
- PowerShell spawning writes under `HKCU`  
- Creation of executable in non-system directory  

###  Beacon Simulation
- Long-running python.exe  
- Predictable timing intervals (10 seconds)  
- Sequential file writes  

---

#  9. Conclusion

This lab successfully replicates three core malware behaviors in a fully controlled and non-malicious environment. Using Sysmon’s detailed telemetry, each stage of activity can be:

- monitored  
- detected  
- analyzed  
- documented  

This setup demonstrates real-world defensive and analytical skills, including:

- Windows internals  
- Malware behavior modeling  
- Endpoint detection engineering  
- Purple-team methodology  
