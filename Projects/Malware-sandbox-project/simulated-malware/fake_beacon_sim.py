"""
fake_beacon_sim.py

This script simulates a "beacon-like" process by periodically appending a
timestamped line to a log file. There is NO network communication.

Using this generates:
- A long-running process
- Repeated file write events (Sysmon EID 11)
"""

import time
from datetime import datetime

LOG_PATH = r"C:\Sandbox\logs\fake_beacon.txt"
INTERVAL_SECONDS = 10
MAX_BEACONS = 30  # stops after 30 cycles to avoid running forever


def main():
    print(f"[+] Fake beacon simulation started. Logging to: {LOG_PATH}")
    for i in range(MAX_BEACONS):
        timestamp = datetime.utcnow().isoformat()
        line = f"{timestamp} :: BEACON {i+1}\n"
        try:
            with open(LOG_PATH, "a", encoding="utf-8") as f:
                f.write(line)
        except Exception as e:
            print(f"[!] Error writing beacon: {e}")
            break

        print(f"[+] Wrote beacon {i+1}, sleeping {INTERVAL_SECONDS}s")
        time.sleep(INTERVAL_SECONDS)

    print("[+] Fake beacon simulation finished.")


if __name__ == "__main__":
    main()

